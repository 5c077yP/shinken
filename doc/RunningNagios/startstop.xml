<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [
<!ENTITY % all.entities SYSTEM "../all-entities.ent">
%all.entities;
]>
<chapter id="runningnagios-startstop" xreflabel="Starting and Stopping Nagios">
  <title>Starting and Stopping Shinken</title>

  <para>There's more than one way to start, stop, and restart Shinken. Here
  are some of the more common ones...</para>

  <tip>
    <para>Always make sure you <xref linkend="runningnagios-verifyconfig" />
    before you (re)start Shinken.</para>
  </tip>

  <section>
    <title>Starting Shinken</title>

    <orderedlist>
      <listitem>
        <para>Init Script: The easiest way to start the Shinken daemon is by
        using the init script like so:</para>

        <screen><prompt>linux:~ # </prompt><userinput>/etc/rc.d/init.d/shinken start</userinput></screen>
      </listitem>

      <listitem>
        <para>Manually: You can start the Shinken daemon manually with the
        <option>-d</option> command line option like so:</para>

        <screen><prompt>linux:~ # </prompt><userinput>/usr/local/shinken/src/shinken-scheduler.py -d -c /usr/local/shinken/src/etc/schedulerd.cfg
</userinput><prompt>linux:~ # </prompt>/usr/local/shinken/src/shinken-poller.py -d -c /usr/local/shinken/src/etc/pollerd.cfg<prompt>
linux:~ # </prompt>/usr/local/shinken/src/shinken-reactionner.py -d -c /usr/local/shinken/src/etc/reactionnerd.cfg<prompt>
linux:~ # </prompt>/usr/local/shinken/src/shinken-broker.py -d -c /usr/local/shinken/src/etc/brokerd.cfg<prompt>
linux:~ # </prompt>/usr/local/shinken/src/shinken-arbiter.py -d -c /usr/local/shinken/src/etc/nagios.cfg</screen>
      </listitem>
    </orderedlist>
  </section>

  <section>
    <title>Restarting Shinken</title>

    <para>Restarting/reloading is nececessary when you modify your
    configuration files and want those changes to take effect.</para>

    <orderedlist>
      <listitem>
        <para>Init Script: The easiest way to restart the Nagios daemon is by
        using the init script like so:</para>

        <screen><prompt>linux:~ # </prompt><userinput>/etc/rc.d/init.d/nagios reload</userinput></screen>
      </listitem>

      <listitem>
        <para>Web Interface: You can restart the Nagios through the web
        interface by clicking the <guimenu>Process Info</guimenu> navigation
        link and selecting <guimenuitem>Restart the Shinken
        process</guimenuitem>: <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata fileref="images/stoprestart.png" format="PNG" />
              </imageobject>
            </mediaobject>
          </screenshot></para>
      </listitem>

      <listitem>
        <para>Manually: You can restart the Nagios process by sending it a
        SIGHUP signal like so:</para>

        <screen><prompt>linux:~ # </prompt><userinput>kill &lt;arbiter_pid&gt;
<prompt>linux:~ # </prompt>/usr/local/shinken/src/shinken-arbiter.py -d -c /usr/local/shinken/src/etc/nagios.cfg
</userinput></screen>
      </listitem>
    </orderedlist>
  </section>

  <section>
    <title>Stopping Nagios</title>

    <orderedlist>
      <listitem>
        <para>Init Script: The easiest way to stop the Shinken daemons is by
        using the init script like so:</para>

        <screen><prompt>linux:~ # </prompt><userinput>/etc/rc.d/init.d/nagios stop</userinput></screen>
      </listitem>

      <listitem>
        <para>Web Interface: You can stop Shinken through the web interface by
        clicking the <guimenu>Process Info</guimenu> navigation link and
        selecting <guimenuitem>Shutdown the Nagios process</guimenuitem>:
        <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata fileref="images/stoprestart.png" format="PNG" />
              </imageobject>
            </mediaobject>
          </screenshot></para>
      </listitem>

      <listitem>
        <para>Manually: You can stop the Nagios process by sending it a
        SIGTERM signal like so:</para>

        <screen><prompt>linux:~ # </prompt><userinput>kill &lt;arbiter_pid&gt; &lt;scheduler_pid&gt; &lt;poller_pid&gt; &lt;reactionner_pid&gt; &lt;broker_pid&gt; </userinput></screen>
      </listitem>
    </orderedlist>
  </section>
</chapter>
